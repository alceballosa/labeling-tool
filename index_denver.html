<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">

    <title>Land Cover Labeling</title>

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <style type="text/css">
        body {
            padding-top: 2rem;
            padding-left: 6rem;
            padding-right: 6em;
        }

        .row {
            margin-bottom: 2rem;
        }

        .center {
            text-align: center;
        }


        #structures{
            color: #000;
            background-color: #ff0000;
            border-color: #ff0000;
        }
        #impervious{
            color: #000;
            background-color: #b2b2b2;
            border-color: #b2b2b2;
        }
        #water{
            color: #000;
            background-color: #00a9e6;
            border-color: #00a9e6;
        }
        #grassland{
            color: #000;
            background-color: #c7d79e;
            border-color: #c7d79e;
        }
        #tree{
            color: #000;
            background-color: #267300;
            border-color: #267300;
        }
        #turf{
            color: #000;
            background-color: #70a800;
            border-color: #70a800;
        }
        #barren{
            color: #000;
            background-color: #ffebaf;
            border-color: #ffebaf;
        }
        #unknown{
            color: #fff;
            background-color: rgb(0, 0, 0);
            border-color: rgb(0, 0, 0);
        }


        #structures:hover{
            color: rgb(255, 255, 255);
        }
        #impervious:hover{
            color: rgb(255, 255, 255);
        }
        #water:hover{
            color: rgb(255, 255, 255);
        }
        #grassland:hover{
            color: rgb(255, 255, 255);
        }
        #tree:hover{
            color: rgb(255, 255, 255);
        }
        #turf:hover{
            color: rgb(255, 255, 255);
        }
        #barren:hover{
            color: rgb(168, 168, 168);
        }
        #unknown:hover{
            color: rgb(168, 168, 168);
        }



        .satelliteImage {
            width: 240px;
            height: 240px;
            border: 1px solid black;
        }

        .satelliteImageHuge {
            width: 100%;
            max-width: 700px;
        }

        .exampleImage{
            display:inline-block;
            width: 5cm;
        }

        table td{
            padding:5px;
            padding-right:10px;
            max-width: 500px;
        }

        .imgContainer {
            padding: 30px;
        }

        .dimmed {
            position: relative;
        }

        .dimmed:after {
            content: " ";
            z-index: 10;
            display: block;
            position: absolute;
            height: 100%;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.5);
        }

        .pixelated {
            image-rendering: pixelated;
            image-rendering: crisp-edges;
            -ms-interpolation-mode: nearest-neighbor;
        }


        .pixelated-container{
            display: inline-block;
            position: relative;
        }

        .red-circle{
            border: 8px double red;
            border-radius: 50%;
            position: absolute;
            top: 33.33333%;
            left: 33.33333%;
            width: 33.33333%;
            height: 33.33333%;
        }

    </style>

</head>

<body>

    <div class="container-fluid">

        <div class="row">
            <div class="col-md-12">
                <h1 class="center">Land cover labeling tool</h1>
            </div>
        </div>

        <div class="row">

            <div class="col-xl-4 col-lg-12 center imgContainer">
                <img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" class="satelliteImageHuge"
                    id="imgHuge" />
                <p class="mt-2">Number of labels submitted: <span id="numLabels">0</span></p>
            </div>

            <div class="col-xl-8 col-lg-12">

                <div class="row center imgContainer">
                    <div class="col-sm-4">
                        <img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" class="satelliteImage pixelated"
                            id="imgLarge" />
                    </div>
                    <div class="col-sm-4">
                        <img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" class="satelliteImage pixelated"
                            id="imgMedium" />
                    </div>
                    <div class="col-sm-4">
                        <div style="margin: auto; width: 240px; height: 240px;">
                            <img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="
                                class="satelliteImage pixelated" id="imgSmall" />
                            <div class="satelliteImage" style="position:absolute;top:0px;padding:90px;">
                                <div style="border:8px double red;border-radius:30px;height:100%;width:100%;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row justify-content-center">
                    <div class="col-xl-4 mb-3">
                        <button type="button" class="btn btn-lg btn-block" id="structures">Structures</button>
                    </div>
                    <div class="col-xl-4 mb-3">
                        <button type="button" class="btn btn-lg btn-block" id="impervious">Impervious Surfaces</button>
                    </div>
                    <div class="col-xl-4 mb-3">
                        <button type="button" class="btn btn-lg btn-block" id="water">Water</button>
                    </div>
                    <div class="col-xl-4 mb-3">
                        <button type="button" class="btn btn-lg btn-block" id="grassland">Grassland/Prairie</button>
                    </div>
                    <div class="col-xl-4 mb-3">
                        <button type="button" class="btn btn-lg btn-block" id="tree">Tree Canopy</button>
                    </div>
                    <div class="col-xl-4 mb-3">
                        <button type="button" class="btn btn-lg btn-block" id="turf">Turf/Irrigated Lands</button>
                    </div>
                    <div class="col-xl-4 mb-3">
                        <button type="button" class="btn btn-lg btn-block" id="barren">Barren/Rock</button>
                    </div>
                    <div class="col-xl-4 mb-3">
                        <button type="button" class="btn btn-lg btn-block" id="unknown">Not Sure</button>
                    </div>
                </div>

                <!-- <div class="row">
                    <div class="col-md-12">
                        <p>Number of labels submitted: <span id="numLabels">0</span></p>
                    </div>
                </div> -->
            </div>

        </div>


        <div class="row">

            <div class="col-md-12 mb-5">
                <h2 class="mb-4">Instructions</h2>
                <p>The top right images show a single area at three levels of decreasing spatial context: 240x240 meters, 120x120
                    meters, and 19x19 meters. The image to the left shows where this 240x240 meter area is located in a much larger
                    context. The red dashed square and red circle highlights the same area in each image.</p>
                <p>Use the buttons to label the <b>central pixel</b> in this area, shown underneath the
                    crosshairs of the third image.</p>
                <p>If you are unsure of the correct labeling <b>do not</b> guess, select "Not Sure".</p>
            </div>

            <div class="col-md-12">
                <h2 class="mb-4">Class examples</h2>
                <p>The following table describes the classes and gives three pairs of example images for each. The image pairs contain examples of the 120x120 and 19x19 meter images you would see above for each class. Remember to press "Not Sure" if you cannot decide which class a point belongs to.</p>
                <div>
                    <table>
                        <tr>
                            <td>
                                <h4>Structures</h4>
                                <p>Human-constructed objects made of impervious materials that are greater than approximately 2 meters in
                                    height. Houses, malls, and electrical towers are examples of structures.</p>
                            </td>
                            <td>
                                <img class="exampleImage pixelated" src="img/examples_denver/class_1_example_0_1.png">
                                <div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_1_example_0_2.png">
                                    <div class="red-circle"></div>
                                </div>
                            </td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_1_example_2_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_1_example_2_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_1_example_4_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_1_example_4_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                        </tr>
                    
                        <tr>
                            <td>
                                <h4>Impervious Surfaces</h4>
                                <p>Human-constructed surfaces through which water cannot penetrate, and that are below approximately 2
                                    meters in height. This includes asphalt, concrete, gravel, pavement, treated lumber (e.g. docks and
                                    decks), and dirt roads/hard-packed dirt lots, etc.</p>
                            </td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_2_example_0_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_2_example_0_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_2_example_2_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_2_example_2_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_2_example_custom_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_2_example_custom_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                        </tr>
                    
                        <tr>
                            <td>
                                <h4>Water</h4>
                                <p>All areas of open water, generally with less than 25% cover of vegetation/land cover. This includes
                                    waterfilled backyard pools, ponds, lakes, rivers, natural tidal pools in wetland areas, and boats that
                                    are not attached to docks.</p>
                            </td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_3_example_0_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_3_example_0_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_3_example_1_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_3_example_1_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_3_example_2_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_3_example_2_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                        </tr>
                    
                        <tr>
                            <td>
                                <h4>Grassland/Prairie</h4>
                                <p>Large open semi-arid areas composed of perennial grasses, herbaceous vegetation, and shrubs. These lands
                                    are often used for ranching and grazing but are not managed beyond these activities. This class also
                                    includes unmanaged natural ground cover that is less than a meter tall, such as wetland areas.</p>
                            </td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_4_example_0_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_4_example_0_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_4_example_3_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_4_example_3_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_4_example_4_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_4_example_4_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                        </tr>
                    
                        <tr>
                            <td>
                                <h4>Tree Canopy</h4>
                                <p>Deciduous and evergreen woody vegetation of either natural succession or human planting that is over
                                    approximately 5 meters in height. Stand-alone individuals, discrete clumps, and interlocking individuals
                                    are included. Includes individual large shrubs.</p>
                            </td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_5_example_0_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_5_example_0_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_5_example_3_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_5_example_3_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_5_example_4_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_5_example_4_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                        </tr>
                    
                        <tr>
                            <td>
                                <h4>Turf/Irrigated Lands</h4>
                                <p>Turf grass and areas of land that are actively managed and watered that do not fall in the cropland
                                    class. Examples of turf: lawns, cemeteries, golf courses, sports fields.</p>
                            </td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_6_example_0_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_6_example_0_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_6_example_2_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_6_example_2_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_6_example_3_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_6_example_3_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                        </tr>
                    
                        <tr>
                            <td>
                                <h4>Barren/Rock</h4>
                                <p>Areas void of vegetation consisting of natural earthen material regardless of how it has been cleared.
                                    This includes beaches, mud flats, bedrock, xeriscaped lawns, and bare ground in construction sites
                                    (hardpacked paths/roads in construction sites would be better suited for the impervious class).</p>
                            </td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_7_example_0_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_7_example_0_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_7_example_3_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_7_example_3_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                            <td><img class="exampleImage pixelated" src="img/examples_denver/class_7_example_4_1.png"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples_denver/class_7_example_4_2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                        </tr>
                    
                        <tr>
                            <td>
                                <h4>Not Sure</h4>
                                <p>Any unclear boundary between two/three other classes should fall into this category.</p>
                            </td>
                            <td><img class="exampleImage pixelated" src="img/examples/unsure1.jpg"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples/unsure1.png">
                                    <div class="red-circle"></div>
                                </div></td>
                            <td><img class="exampleImage pixelated" src="img/examples/unsure2.jpg"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples/unsure2.png">
                                    <div class="red-circle"></div>
                                </div></td>
                            <td><img class="exampleImage pixelated" src="img/examples/unsure3.jpg"><div class="pixelated-container">
                                    <img class="exampleImage pixelated" src="img/examples/unsure3.png">
                                    <div class="red-circle"></div>
                                </div></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>


    </div>

    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>

    <script type="text/javascript">

        var BACKEND_URL = "http://msrcalebubuntu1.eastus.cloudapp.azure.com:4042/"
        var isLoading = false;

        var currentSample = null;
        var numLabels = 0;

        var notifyFail = function (jqXHR, textStatus, errorThrown) {
            var response = $.parseJSON(jqXHR.responseText);
            console.log("Error in processing server: " + response.error);
        };


        var recordSample = function(label) {
            currentSample["label"] = label;

            $.ajax({
                type: "POST",
                url: BACKEND_URL + "recordSample",
                data: JSON.stringify(currentSample),
                success: function (data, textStatus, jqXHR) {

                    numLabels += 1;
                    $("#numLabels").text(numLabels);
                    getSample();
                },
                error: notifyFail,
                dataType: "json",
                contentType: "application/json"
            });

        };

        var getSample = function () {
            $(".imgContainer").addClass("dimmed");
            isLoading = true;

            $.ajax({
                type: "POST",
                url: BACKEND_URL + "getSample",
                data: JSON.stringify({ "sample": true }),
                success: function (data, textStatus, jqXHR) {

                    var imgLarge = "data:image/jpeg;base64," + data["imgLarge"];
                    var imgMedium = "data:image/jpeg;base64," + data["imgMedium"];
                    var imgSmall = "data:image/png;base64," + data["imgSmall"];

                    var imgHuge = "data:image/jpeg;base64," + data["imgHuge"];

                    $("#imgLarge").attr("src", imgLarge);
                    $("#imgMedium").attr("src", imgMedium);
                    $("#imgSmall").attr("src", imgSmall);

                    $("#imgHuge").attr("src", imgHuge);

                    delete data["imgLarge"];
                    delete data["imgMedium"];
                    delete data["imgSmall"];
                    delete data["imgHuge"];

                    currentSample = data;
                    $(".imgContainer").removeClass("dimmed");
                    isLoading = false;
                },
                error: notifyFail,
                dataType: "json",
                contentType: "application/json"
            });
        };


        $(document).ready(function () {

            getSample();

            $(".btn").click(function () {
                if (!isLoading) {
                    recordSample(this.id);
                }
            })

            $(document).keypress(function (e) {
                if (!isLoading) {

                }
                e.preventDefault();
            });

        });

    </script>
</body>

</html>
